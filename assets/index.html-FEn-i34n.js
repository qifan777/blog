const n=JSON.parse('{"key":"v-323dccd4","path":"/knowledge/tips/excel-read/","title":"上传Excel并解析","lang":"zh-CN","frontmatter":{"title":"上传Excel并解析","layout":"Slide","presentation":{"height":1000,"themes":["white"]},"description":" @slidestart @slideend ","head":[["meta",{"property":"og:url","content":"https://mister-hope.github.io/blog/knowledge/tips/excel-read/"}],["meta",{"property":"og:site_name","content":"起凡Code闲聊"}],["meta",{"property":"og:title","content":"上传Excel并解析"}],["meta",{"property":"og:description","content":" @slidestart @slideend "}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-02-04T11:55:25.000Z"}],["meta",{"property":"article:author","content":"起凡"}],["meta",{"property":"article:modified_time","content":"2024-02-04T11:55:25.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"上传Excel并解析\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-02-04T11:55:25.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"起凡\\",\\"url\\":\\"https://www.jarcheng.top\\"}]}"]]},"headers":[],"git":{"createdTime":1707047725000,"updatedTime":1707047725000,"contributors":[{"name":"linjiacheng","email":"1507906763@qq.com","commits":1}]},"readingTime":{"minutes":0.88,"words":263},"filePathRelative":"knowledge/tips/excel-read/README.md","localizedDate":"2024年2月4日","excerpt":"<!-- # 上传Excel并解析\\n\\n:::center\\n![excel数据](./excel.png)\\n\\n![解析展示](./table.png)\\n::: -->\\n<p>@slidestart</p>\\n<div class=\\"language-java\\" data-ext=\\"java\\" data-title=\\"java\\"><pre class=\\"language-java\\"><code><span class=\\"token annotation punctuation\\">@RestController</span>\\n<span class=\\"token annotation punctuation\\">@Slf4j</span>\\n<span class=\\"token annotation punctuation\\">@AllArgsConstructor</span>\\n<span class=\\"token keyword\\">public</span> <span class=\\"token keyword\\">class</span> <span class=\\"token class-name\\">TestController</span> <span class=\\"token punctuation\\">{</span>\\n\\n    <span class=\\"token annotation punctuation\\">@SneakyThrows</span>\\n    <span class=\\"token annotation punctuation\\">@PostMapping</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">\\"read-user-excel\\"</span><span class=\\"token punctuation\\">)</span>\\n    <span class=\\"token keyword\\">public</span> <span class=\\"token class-name\\">List</span><span class=\\"token generics\\"><span class=\\"token punctuation\\">&lt;</span><span class=\\"token class-name\\">UserExcelModel</span><span class=\\"token punctuation\\">&gt;</span></span> <span class=\\"token function\\">readUserExcel</span><span class=\\"token punctuation\\">(</span><span class=\\"token annotation punctuation\\">@RequestParam</span> <span class=\\"token class-name\\">MultipartFile</span> file<span class=\\"token punctuation\\">)</span> <span class=\\"token punctuation\\">{</span>\\n        <span class=\\"token class-name\\">List</span><span class=\\"token generics\\"><span class=\\"token punctuation\\">&lt;</span><span class=\\"token class-name\\">UserExcelModel</span><span class=\\"token punctuation\\">&gt;</span></span> models <span class=\\"token operator\\">=</span> <span class=\\"token keyword\\">new</span> <span class=\\"token class-name\\">ArrayList</span><span class=\\"token generics\\"><span class=\\"token punctuation\\">&lt;</span><span class=\\"token punctuation\\">&gt;</span></span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n        <span class=\\"token class-name\\">EasyExcel</span><span class=\\"token punctuation\\">.</span><span class=\\"token function\\">read</span><span class=\\"token punctuation\\">(</span>file<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">getInputStream</span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span>\\n                <span class=\\"token class-name\\">UserExcelModel</span><span class=\\"token punctuation\\">.</span><span class=\\"token keyword\\">class</span><span class=\\"token punctuation\\">,</span>\\n                <span class=\\"token keyword\\">new</span> <span class=\\"token class-name\\">PageReadListener</span><span class=\\"token generics\\"><span class=\\"token punctuation\\">&lt;</span><span class=\\"token class-name\\">UserExcelModel</span><span class=\\"token punctuation\\">&gt;</span></span><span class=\\"token punctuation\\">(</span>dataList <span class=\\"token operator\\">-&gt;</span> <span class=\\"token punctuation\\">{</span>\\n                    models<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">addAll</span><span class=\\"token punctuation\\">(</span>dataList<span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n                    <span class=\\"token keyword\\">for</span> <span class=\\"token punctuation\\">(</span><span class=\\"token class-name\\">UserExcelModel</span> demoData <span class=\\"token operator\\">:</span> dataList<span class=\\"token punctuation\\">)</span> <span class=\\"token punctuation\\">{</span>\\n                        log<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">info</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">\\"读取到一条数据{}\\"</span><span class=\\"token punctuation\\">,</span> demoData<span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n                    <span class=\\"token punctuation\\">}</span>\\n                <span class=\\"token punctuation\\">}</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">.</span><span class=\\"token function\\">excelType</span><span class=\\"token punctuation\\">(</span><span class=\\"token class-name\\">ExcelTypeEnum</span><span class=\\"token punctuation\\">.</span><span class=\\"token constant\\">XLSX</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">.</span><span class=\\"token function\\">sheet</span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">.</span><span class=\\"token function\\">doRead</span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n        <span class=\\"token keyword\\">return</span> models<span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token punctuation\\">}</span>\\n    <span class=\\"token annotation punctuation\\">@Data</span>\\n    <span class=\\"token keyword\\">public</span> <span class=\\"token keyword\\">static</span> <span class=\\"token keyword\\">class</span> <span class=\\"token class-name\\">UserExcelModel</span> <span class=\\"token punctuation\\">{</span>\\n        <span class=\\"token annotation punctuation\\">@ExcelProperty</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">\\"ID\\"</span><span class=\\"token punctuation\\">)</span>\\n        <span class=\\"token keyword\\">private</span> <span class=\\"token class-name\\">String</span> id<span class=\\"token punctuation\\">;</span>\\n        <span class=\\"token annotation punctuation\\">@ExcelProperty</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">\\"用户名\\"</span><span class=\\"token punctuation\\">)</span>\\n        <span class=\\"token keyword\\">private</span> <span class=\\"token class-name\\">String</span> username<span class=\\"token punctuation\\">;</span>\\n        <span class=\\"token annotation punctuation\\">@ExcelProperty</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">\\"性别\\"</span><span class=\\"token punctuation\\">)</span>\\n        <span class=\\"token keyword\\">private</span> <span class=\\"token class-name\\">String</span> gender<span class=\\"token punctuation\\">;</span>\\n        <span class=\\"token annotation punctuation\\">@ExcelProperty</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">\\"手机号\\"</span><span class=\\"token punctuation\\">)</span>\\n        <span class=\\"token keyword\\">private</span> <span class=\\"token class-name\\">String</span> phone<span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token punctuation\\">}</span>\\n<span class=\\"token punctuation\\">}</span>\\n</code></pre></div>","autoDesc":true}');export{n as data};
